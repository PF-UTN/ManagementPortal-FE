<form
  [formGroup]="supplierForm"
  class="container-fluid p-3"
  (keydown.enter)="onSubmit()"
>
  <div class="mb-4">
    <mat-form-field class="w-100" appearance="outline">
      <mat-label>Tipo de Documento</mat-label>
      <mat-select formControlName="documentType">
        <mat-option *ngFor="let type of documentTypes" [value]="type">
          {{ type }}
        </mat-option>
      </mat-select>
      <mat-error
        *ngIf="
          supplierForm.controls.documentType?.hasError('required') &&
          supplierForm.controls.documentType?.touched
        "
      >
        Tipo de Documento es requerido
      </mat-error>
    </mat-form-field>
  </div>
  <div class="mb-4">
   <mp-input
      type="text"
      label="Número Documento"
      formControlName="documentNumber"
      [maxlength]="supplierForm.controls.documentType.value === 'DNI' ? 8 : (supplierForm.controls.documentType.value === 'CUIT' || supplierForm.controls.documentType.value === 'CUIL' ? 11 : null)"
      (keydown)="preventNonNumericInput($event)"
      [hint]="documentNumberHint"
    ></mp-input>
  </div>
  <div *ngIf="isSearchingSupplier()" class="d-flex justify-content-center my-4">
    <mp-loading></mp-loading>
  </div>
  <ng-container *ngIf="!isSearchingSupplier()">
    <div class="mb-4">
      <mp-input
        type="text"
        label="Razón Social"
        formControlName="businessName"
        icon="close"
      />
    </div>
    <div class="mb-4">
      <mp-input
        type="email"
        label="Email"
        formControlName="email"
        icon="close"
      />
    </div>
    <div class="mb-4">
      <mp-input
        type="text"
        label="Teléfono"
        formControlName="phone"
        icon="close"
      />
    </div>
    <div class="row g-3 mb-4">
      <div class="col-7">
        <mp-input
          type="text"
          label="Calle"
          formControlName="street"
          icon="close"
        />
      </div>
      <div class="col-5">
        <mp-input
          type="number"
          label="Número"
          formControlName="streetNumber"
          icon="close"
        />
      </div>
    </div>
    <div class="mb-4">
      <mp-input
          label="Ciudad"
          formControlName="town"
          [icon]="'close'"
          [errorMessages]="{
            invalidTown: 'Debe seleccionar una ciudad de la lista.'
          }"
          type="text"
          placeholder="Buscar ciudad o código postal"
          [matAutocomplete]="auto"
        ></mp-input>
        <mat-autocomplete #auto="matAutocomplete"
          [displayWith]="displayTown.bind(this)">
          <mat-option *ngFor="let town of filteredTowns$ | async" [value]="town">
            {{ town.name }} ({{ town.zipCode }})
          </mat-option>
        </mat-autocomplete>
    </div>
  </ng-container>
</form>
